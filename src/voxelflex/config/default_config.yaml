# Default configuration for VoxelFlex (Temperature-Aware)

input:
  voxel_file: input_data/voxel/mdcath_voxelized.hdf5
  aggregated_rmsf_file: input_data/rmsf/aggregated_rmsf_all_temps.csv
  train_split_file: input_data/train_domains.txt
  val_split_file: input_data/val_domains.txt
  test_split_file: input_data/test_domains.txt
  max_domains: null  # Set to null or remove if no limit desired

data:
  processed_dir: input_data/processed/
  master_samples_file: "master_samples.parquet"
  # Path for temp scaling params generated by preprocess
  temp_scaling_params_file: "temp_scaling_params.json"

output:
  base_dir: outputs/
  run_name: "voxelflex_run_{timestamp}"
  log_file: voxelflex.log
  # run_dir, log_dir etc. are generated dynamically by config.py

model:
  architecture: multipath_rmsf_net  # Or your preferred model
  input_channels: 5
  voxel_depth: 21
  voxel_height: 21
  voxel_width: 21
  # --- Architecture Specific Params ---
  densenet:
    growth_rate: 16
    block_config: [4, 4, 4]
    num_init_features: 32
    bn_size: 4
  channel_growth_rate: 1.5
  num_residual_blocks: 3
  base_filters: 32
  dropout_rate: 0.3

training:
  # --- Chunk size for IterableDataset ---
  chunk_size: 100  # Number of domains per chunk
  # -------------------------------------------
  batch_size: 128  # Keep relatively high if RAM allows chunk loading
  num_epochs: 5
  learning_rate: 0.0005
  weight_decay: 1e-4
  seed: 42
  num_workers: 2  # Adjust based on CPU cores and memory for chunk processing
  pin_memory: true  # Usually beneficial with GPU
  prefetch_factor: 2  # Default for DataLoader
  resume_checkpoint: null
  save_best_metric: "val_pearson"  # Or val_loss
  save_best_mode: "max"  # Or min
  checkpoint_interval: 5
  gradient_clipping:
    enabled: true
    max_norm: 1.0
  mixed_precision:
    enabled: true  # Highly recommended
  gradient_accumulation_steps: 1  # Adjust if batch_size needs reduction
  scheduler:
    type: reduce_on_plateau
    monitor_metric: "val_pearson"
    mode: "max"
    patience: 5
    factor: 0.5
    min_lr: 1e-07
    threshold: 0.001
  early_stopping:
    enabled: true
    patience: 10
    monitor_metric: "val_pearson"
    mode: "max"
    min_delta: 0.001

prediction:
  batch_size: 256  # Batch size for predict/evaluate

evaluation:
  calculate_stratified_metrics: true
  calculate_permutation_importance: true
  sasa_bins: [0.0, 0.1, 0.4, 1.01]
  permutation_n_repeats: 5

logging:
  level: INFO  # Overall level for file/console if others not set
  console_level: INFO
  file_level: DEBUG
  show_progress_bars: true
  log_timing: false  # Enable if you want detailed timing info
  log_memory_usage: true  # Keep this enabled

visualization:
  plot_loss: true
  plot_correlation: true
  plot_predictions: true
  plot_density_scatter: true
  plot_error_distribution: true
  plot_residue_type_analysis: true
  plot_sasa_error_analysis: true
  plot_ss_error_analysis: true
  plot_amino_acid_performance: false
  save_format: png
  dpi: 150
  max_scatter_points: 1000
  save_plot_data: true

system_utilization:
  detect_cores: true
  adjust_for_gpu: true